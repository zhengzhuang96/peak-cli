"use strict";var e=require("commander"),t=require("tslib"),r=require("chalk"),n=require("figlet"),i=require("readline"),o=require("fs-extra"),a=require("inquirer"),c=require("path"),s=require("fs");function u(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var d=u(r),l=u(c);const p=e=>console.log(e),m=require("ora"),v=require("download-git-repo"),f=(e,r)=>t.__awaiter(void 0,void 0,void 0,(function*(){return new Promise(((n,i)=>{let o;switch(e){case"taro":o="github:zhengzhuang96/taro-react#main";break;case"react-admin":o="git@github.com:zhengzhuang96/react-admin-project-template.git#master"}const a=m(`ğŸš• æ­£åœ¨åˆ›å»º ${e} é¡¹ç›®æ¨¡ç‰ˆ...\n`);a.start(),v(o,r,{clone:!0},(function(e){return t.__awaiter(this,void 0,void 0,(function*(){p(e?`Error: ${e}`:"Success"),e?(a.fail(`ğŸš• ä¸‹è½½å¤±è´¥: ${e}`),n(!1)):(a.succeed("ğŸš• ä¸‹è½½æˆåŠŸ"),n(!0))}))}))}))})),g=require("cross-spawn"),y=require("chalk");var w="0.0.8";const h=()=>t.__awaiter(void 0,void 0,void 0,(function*(){(()=>{const e="\n".repeat(process.stdout.rows);console.log(e),i.cursorTo(process.stdout,0,0),i.clearScreenDown(process.stdout)})(),p(d.default.yellow(n.textSync("peak-cli",{horizontalLayout:"full"}))),p(`ğŸ—¼ peak-cli v${w}`),p(""),p(d.default.green("peak-cli å³å°†åˆ›å»ºä¸€ä¸ªæ–°é¡¹ç›®!")),p("éœ€è¦å¸®åŠ©? è¯·åœ¨ https://github.com/zhengzhuang96/peak-cli æäº¤issue"),p("");const{project:e,description:r,typeProject:u,nodeInstall:m}=yield t.__awaiter(void 0,void 0,void 0,(function*(){const e=[{type:"input",name:"project",message:"è¯·è¾“å…¥é¡¹ç›®åç§°",validate:e=>t.__awaiter(void 0,void 0,void 0,(function*(){if(!e)return"è¯·è¾“å…¥é¡¹ç›®åç§°";const t=c.join(process.cwd(),e);return!o.existsSync(t)||`ç›®æ ‡ç›®å½• ${d.default.cyan(t)} å·²ç»å­˜åœ¨ï¼Œè¯·æ¢ä¸€ä¸ªé¡¹ç›®åï¼`}))},{type:"input",name:"description",message:"è¯·è¾“å…¥é¡¹ç›®ä»‹ç»"},{type:"list",name:"nodeInstall",message:"ä½¿ç”¨é‚£ç§æ–¹å¼æ„å»ºé¡¹ç›®?",default:"yarn",choices:[{name:"yarn",value:"yarn"},{name:"pnpm",value:"pnpm"},{name:"npm",value:"npm"}]},{type:"list",name:"typeProject",message:"é¡¹ç›®ç±»å‹",default:"vue",choices:[{name:"react - react admin",value:"react-admin"},{name:"taro - ç§»åŠ¨ç«¯è·¨å¹³å°",value:"taro"}]}],{project:r,description:n,typeProject:i,nodeInstall:s}=yield a.prompt(e);return{project:r,description:n,typeProject:i,nodeInstall:s}}));yield f(u,e),yield((e,r)=>t.__awaiter(void 0,void 0,void 0,(function*(){const t=require(c.join(process.cwd(),e,"package.json"));return t.name=e,t.description=r,yield s.writeFileSync(c.join(process.cwd(),e,"package.json"),JSON.stringify(t,null,2)),!0})))(e,r),yield((e,t)=>new Promise(((r,n)=>{p(""),p(y.green("ğŸŒ å¼€å§‹å®‰è£…ä¾èµ–é¡¹...")),p("");const i=l.default.join(process.cwd(),t);g(e,["install"],{cwd:i,stdio:"inherit"}).on("close",(function(e){p(""),p(y.green("ğŸŒ å®‰è£…ä¾èµ–é¡¹å®Œæˆ!")),r()}))})))(m,e),((e,t,r)=>{const n=`${t}`;if("taro"===t){p(`\r\næˆåŠŸåˆ›å»ºäº†é¡¹ç›® ${d.default.green(r)}`),p(`\r\n  cd ${d.default.green(r)}`);const t="yarn"===e?"yarn":`${e} run`;p(`  ${d.default.green(`${t} dev:weapp`)}\r\n`)}})(m,u,e)})),j=new e.Command;j.version(w).command("create").description("åˆ›å»ºæ–°çš„é¡¹ç›®").action((()=>{h()})),j.parse();
